# 06 コンフリクトの理解と解決

## 1. この章のゴール
- コンフリクト（衝突）が起きる理由を、怖がらずに説明できる。
- Sourcetree でコンフリクトが起きたときの “見え方” を理解する。
- VS Code を使ってコンフリクトを解決し、コミットして先に進める。

## 2. 概念の説明（図や比喩を使ってわかりやすく）
- **コンフリクト**：同じファイルの同じ場所を、別々の変更が同時に書き換えたときに起きます。
- Git は「どっちを採用すべきか自動で決められない」ので、一旦止まってあなたに選んでもらいます。
- たとえるなら「二人が同じホワイトボードの同じ行を同時に書き換えた状態」です。

怖く見えるだけで、やることはシンプルです：
1) どっちの内容を残すか決める → 2) ファイルを整える → 3) “解決済み” にしてコミットする

## 3. 実際の操作手順（Sourcetree + VS Code）
### 3-1. まず予防：コンフリクトを減らすコツ
- 作業開始前に `develop` をチェックアウト → `Pull` で最新化
- 同じファイルを長時間編集し続けない（区切りでコミット）

### 3-2. コンフリクトが起きたときの “見え方”（Sourcetree）
- `Pull` や `Merge` の途中で止まる
- `Conflicts` の表示が出る
- `File Status` に赤いアイコンのファイルが並ぶ

[ここに Sourcetree の「Conflicts」表示のスクリーンショットを挿入]

### 3-3. 解決する（VS Codeで編集）
- Sourcetree の `File Status` で、衝突しているファイルをクリック
- `Resolve Conflicts` / `Open in External Merge Tool`（表示名は環境で異なる）を選ぶ
- VS Code が開いたら、次を確認する
  - `<<<<<<` や `======` のような “コンフリクトマーカー” が見える
  - VS Code のマージ画面が出る場合は、`Accept Current` / `Accept Incoming` などのボタンが出る
- 「最終的に残したい文章」になるように整える（両方必要なら両方残して OK）
- 保存する

[ここに VS Code のマージ画面（コンフリクト解決UI）のスクリーンショットを挿入]

### 3-4. “解決済み” にしてコミットする（Sourcetree）
- Sourcetree に戻る
- そのファイルが “Resolved” になっているか確認（必要なら `Mark Resolved` を押す）
- ステージング → コミット（例：`Resolve conflict in README`）
- 必要なら `Push`

### 3-5. PRで「Conflicts」と出たとき（いちばん多い実戦パターン）
GitHub の PR 画面で `This branch has conflicts` のように表示されたら、だいたい「`develop` 側が進んでいて、あなたの `feature` が古い」状態です。  
やることは **feature に develop を取り込んで（マージして）押し上げる** だけです。

1) `develop` を最新化
- Sourcetree で `develop` をチェックアウト
- `Pull` で最新化

2) `feature` に `develop` をマージ
- `feature/task1`（自分の PR のブランチ）をチェックアウト
- 上部の `Merge` をクリック
- 取り込み元に `develop` を選ぶ → `OK`

3) コンフリクトが出たら解決
- もし `Conflicts` が出たら、この章の `3-3`〜`3-4` の手順で解決 → コミット

4) `feature` をプッシュ
- `Push` して GitHub に反映
- PR 画面を更新して、`Able to merge`（または同等の表示）になればOK

[ここに GitHub の PR で Conflicts 表示が出ているスクリーンショットを挿入]

## 4. よくあるミス・つまずきポイント
- コンフリクトマーカー（`<<<<<<` など）を残したままコミットしてしまう → コミット前にファイルを必ず開いて確認。
- “どっちか分からないけど消した” で進めてしまう → 不安なら先生に相談して OK。
- そもそも `develop` を最新化していない → まず `develop` で `Pull` の習慣。

## 5. AIに聞いてみよう（質問例）
このページを開いたまま、下のテンプレをコピペして質問すると「どっちを残す？」の判断がしやすくなります。

**コピペ用テンプレ（コンフリクト解決）**
```md
初心者です。いま「06 コンフリクトの理解と解決」を開いています。

どこで起きた：Pull / Merge / PR（GitHubでConflicts表示）
対象ブランチ：develop / feature/___
衝突しているファイル：（例）practice.md
やりたいこと：（例）両方の変更を残して整えたい / Aを残してBを捨てたい
スクショ：（SourcetreeのConflicts表示、VS Codeのマージ画面、PRのConflicts表示）
もし貼れるなら：衝突部分のテキスト（秘密情報なし）
```

- 「このコンフリクト（スクショ）で、どの部分を残すべきか判断の考え方を教えて」
- 「Sourcetree で “Mark Resolved” が出ない。どこを見ればいい？」
- 「コンフリクトマーカーの意味を、初心者向けに説明して」

## 6. ハンズオン課題（成果物提出を想定）
- 第2章の「模擬課題2（コンフリクト練習）」を実施し、PRでConflictsが出た状態から解決してマージする。
- チーム作業を想定して、同じファイル（例：`README.md`）を別々のブランチで編集してみる。
- コンフリクトが起きたら、VS Code で解決してコミットする。
- PR のコメント欄に「どう解決したか」を1行で説明してみる（例：両方の文章を残して整形しました）。

## 7. チェックリスト（理解確認）
- [ ] コンフリクトが起きる理由を説明できる。
- [ ] Sourcetree でコンフリクトの状態を見分けられる。
- [ ] VS Code で解決してコミットまでできる。
