# add / commit / push とログの読み方

> 提出ブランチ：`feature/03-daily-operations`（PRのbase：`develop`）

## 1. この章のゴール
- Sourcetree で「ステージング → コミット → プッシュ」まで迷わずできる。
- 変更履歴（ログ）を見て「いつ・何をしたか」を説明できる。
- こまめにコミットする理由を、自分の言葉で言えるようになる。

## 2. 概念の説明
- **ステージング（index）**：コミットに入れる変更を選ぶ場所です。「提出トレーに乗せる」イメージ。
- **コミット（commit）**：保存ポイントです。「封筒に入れて封をする」イメージ。
- **プッシュ（push）**：コミットを GitHub（ネット上の金庫）へ送ります。「封筒を郵送する」イメージ。
- **プル（pull）**：GitHub 側の変更を自分の PC に取り込みます（ダウンロード＋反映）。
- **ログ（history）**：コミットの履歴。困ったときに「どこまで戻れるか」が分かります。

## 3. 実際の操作手順（Sourcetree + エディタ）
### 3-0. まず確認：今いるブランチ（事故防止）
ブランチは「今どの作業台にいるか」です。ここを見落とすと、`main` や `develop` にコミットしてしまいます。

- Sourcetree 左のブランチ一覧で、**太字 / チェックマーク** になっているものが「今いるブランチ」です
- 課題作業中は基本 `feature/...` にいるのが正解です

目印：
- 左サイドバーの `Branches` セクションに、ブランチ名が並びます
- 太字/チェックの行が「今いるブランチ」です（ここだけ見れば事故が激減します）

### 3-1. 編集する（エディタ）
- お使いのエディタ（例：VS Code）でファイルを編集して `保存` する（ここが "変更が発生する瞬間" です）

### 3-2. 変更を確認する（Sourcetree）
- Sourcetree の左側で対象リポジトリを選ぶ
- 上部タブの `File Status`（ファイルステータス）を開く
- `Unstaged files`（未ステージ）に変更ファイルが出ていることを確認

目印：`File Status` 画面の中央に `Unstaged files / Staged files` が表示され、ファイルをクリックすると差分（diff）が見られます。

もし `Unstaged files` に何も出ないとき：
- エディタで保存できているか確認（未保存マークが消えているか）
- Sourcetree で「別のリポジトリ」を開いていないか確認（左のリポジトリ名）
- `File Status` を開き直す（別タブ→戻る でOK）

### 3-3. ステージングする（コミットに入れる変更を選ぶ）
- `Unstaged files` のファイルをクリックして差分を確認
- 右側の `Stage`（＋/チェック）をクリックして `Staged files` に移す  
  - 「全部まとめて OK」なら “全部ステージ” でも大丈夫です
  - 慣れてきたら「必要なファイルだけ」を選ぶと事故が減ります

### 3-4. コミットする（保存ポイントを作る）
- コミットメッセージを書く（例：`task1: READMEに自己紹介を追加`）
- `Commit` をクリック

**メッセージのコツ**：後で見返したとき「何をしたか」が分かる日本語で OK です。  
（`update` だけは避けましょう）

### 3-4.5 コミットできないとき（ここを見る）
- `Staged files` が空になっていない？ → 先にステージングする
- 「名前/メールが必要」と言われる → 第1章の「3-3.5（ユーザー情報設定）」を実施する
- 余計なファイルが混ざって怖い → いったん `Unstage` して、必要なファイルだけステージする

### 3-5. ログ（履歴）を読む
- `History`（履歴）タブを開く
- 直前のコミットが追加されていることを確認
- コミットをクリックすると「どのファイルをどう変えたか」が見られます

目印：`History` ではコミット一覧（メッセージ/日時）が並び、選ぶと変更内容（diff）が表示されます。

### 3-6. プッシュする（GitHubへ送る）
- 上部の `Push` をクリック
- 送るブランチ（例：`feature/03-commit-practice`）にチェックが入っていることを確認
- `Push` をクリック

目印：`Push` ダイアログで “チェックが付いているブランチ” が送られます。`feature/...` にチェックがあるか必ず確認します。

### 3-7. プルする（GitHubの変更を取り込む）
作業前や、PR がマージされた後は “最新化” が大切です。

- 上部の `Pull` をクリック
- 取り込み先ブランチが正しいか確認（`develop` など）

※ `Fetch` は「ダウンロードだけ」、`Pull` は「ダウンロード＋反映」です。最初は `Pull` で OK。

### 3-8. 事故防止チェック（コミット前 / プッシュ前）
**コミット前**
- `Staged files` に「入れていいファイルだけ」入っている？
- 差分を見て、意図しない変更（空白だけ、設定ファイルなど）が混ざっていない？
- パスワード・トークン・個人情報が入っていない？（例：`.env`、個人メモ、画像ファイル）

**プッシュ前**
- 今いるブランチが `feature/...` になっている？
- 送るブランチ（チェック）が正しい？

### 3-9. （おすすめ）`.gitignore` で「余計なファイル」を最初から防ぐ
`.gitignore` は「コミットしないファイル一覧」です。初心者の事故（`node_modules` や `.env` を上げる）を強力に防げます。

例（必要なものだけ入れてOK）:
```gitignore
.DS_Store
node_modules/
.env
```

作り方：
- お使いのエディタ（例：VS Code）でリポジトリ直下に `.gitignore` という名前のファイルを作る（拡張子なし）
- 中に上の行を貼る → 保存 → 通常通りコミットしてOK

## 4. よくあるミス・つまずきポイント
- まとめて巨大なコミットになり、差分が追えない → 「区切り」でコミットする。
- ステージングせずにコミットしようとして「何もコミットされない」 → `Staged files` を確認する。
- 初回に「名前/メール」が未設定でコミットが失敗する → 第1章のユーザー情報設定を行う。
- プッシュし忘れて、GitHub に反映されていない → 「コミット＝PC内」「プッシュ＝金庫へ」を思い出す。
- プッシュできない（認証エラー） → 第1章の認証設定を再確認、または Sourcetree を再起動してログインし直す。

### 4-1. “やり直し”の基本（Sourcetreeで安全に戻る）
初心者は「戻せないのが怖い」と感じがちですが、ここを覚えると一気に安心できます。

#### ステージングを戻したい（コミットに入れたくない）
- `File Status` → `Staged files` の対象ファイルを右クリック
- `Unstage` / `Remove from index` を選ぶ（表示名は環境で異なります）

#### 間違って `.env` などをステージしてしまった（秘密情報は守る）
- まず `Unstage` で外す
- `.gitignore` に `.env` を追加する
- その後、必要なファイルだけをステージしてコミットする

※ もし `.env` を **プッシュまでしてしまった** 場合は、メンターに相談してください（基本は「秘密情報を無効化・作り直し」が必要です）。

#### 変更をなかったことにしたい（※戻せないので注意）
- `File Status` → 対象ファイルを右クリック → `Discard` / `Reset` を探す
- 不安なら、先にファイル内容をコピーしてメモに退避してから実行する

#### 直前のコミットメッセージを直したい（まだプッシュしていない）
- もう一度コミット画面を開き、`Amend last commit`（直前コミットを修正）を探す
- メッセージを直してコミット
- その後に `Push`

※ すでにプッシュ済みの場合は、無理に書き換えず「追加コミット」で直すのが安全です。

#### 間違ったコミットを取り消したい（安全版）
履歴を消さずに “打ち消すコミット” を追加する方法です。プッシュ済みでも安全です。

- `History` で取り消したいコミットを右クリック
- `Reverse commit` / `Revert` を選ぶ
- 新しいコミットが追加されたことを確認して `Push`
目印：`History` のコミット行を右クリックするとメニューが出ます。`Reverse commit` / `Revert` は「取り消し用の新しいコミットを作る」安全な方法です。

## 5. AIに聞いてみよう（質問例）
AIは今開いているページを自動で把握しています。状況だけ伝えればOKです。

**コピペ用テンプレ（コミット/プッシュ）**
```md
今いるブランチ：（Sourcetreeで太字/チェックのブランチ名）
File Statusの状態：Unstaged files（ある/ない）、Staged files（ある/ない）
やりたいこと：（例）コミットしたい / プッシュしたい / 直前のコミットを取り消したい
起きていること：（例）Commitが押せない / Pushで失敗する
エラー全文：（あればそのまま）
```

### 5-1. 具体例（このまま質問してOK）
```text
「いま `3-3 ステージング` です。`Staged files` に入っているのは（ファイル名：___）。この状態でコミットしてOK？分けた方がいいなら、コミット案（メッセージも）を提案して」
「`3-4 コミット` で `Commit` が押せない。`Staged files` が空かどうかも含めて、チェックする順番を “クリック手順” で教えて」
「`3-6 プッシュ` で、Push画面のどこにチェックを入れる？“送るブランチ” を間違えない確認ポイントを3つだけ教えて」
「`History` を見ています。このコミットを取り消したいけど、**もうプッシュ済み**。安全に戻す方法（Revertの手順）をSourcetreeの右クリックメニュー名つきで教えて」
「`3-9 .gitignore` を作りたい。いま見えている “余計なファイル” は（ファイル名：___）。初心者向けに、入れるべき行だけ提案して」
「この章の内容で、私の状況だと “Pull/FETCH/Push” のどれを押すべき？（状況：___、エラー：___）」
```

## 6. ハンズオン課題（成果物提出を想定）
- `README.md` を編集して、意味のある単位でコミットを2回以上行う（例：自己紹介追加→学習メモ追加）。
- GitHub を開き、コミットが反映されていること（履歴が増えていること）を確認する。

## 7. チェックリスト（理解確認）
- [ ] ステージング／コミット／プッシュの違いを説明できる。
- [ ] Sourcetree の `History` で履歴を確認できる。
- [ ] 「コミットは小さく」を説明できる。

---

## 課題提出

この章には提出課題があります。

1. 上記のハンズオン課題を完了する
2. GitHub で `feature/03-daily-operations` ブランチを作成し、PRを作成
3. [AI総合レビューツール](https://ai.studio/apps/drive/1AMqIqU4Bio4te7AWh5dly1Qzp7CesqP9?fullscreenApplet=true) でレビューを実行
4. 問題がなければ、スプレッドシートに **PR URL** と **完了日** を記入
