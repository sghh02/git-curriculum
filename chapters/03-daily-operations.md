# 03 add/commit/pushとログの読み方

## 1. この章のゴール
- Sourcetree で「ステージング → コミット → プッシュ」まで迷わずできる。
- 変更履歴（ログ）を見て「いつ・何をしたか」を説明できる。
- こまめにコミットする理由を、自分の言葉で言えるようになる。

## 2. 概念の説明（図や比喩を使ってわかりやすく）
- **ステージング（index）**：コミットに入れる変更を選ぶ場所です。「提出トレーに乗せる」イメージ。
- **コミット（commit）**：保存ポイントです。「封筒に入れて封をする」イメージ。
- **プッシュ（push）**：コミットを GitHub（ネット上の金庫）へ送ります。「封筒を郵送する」イメージ。
- **プル（pull）**：GitHub 側の変更を自分の PC に取り込みます（ダウンロード＋反映）。
- **ログ（history）**：コミットの履歴。困ったときに「どこまで戻れるか」が分かります。

## 3. 実際の操作手順（Sourcetree + VS Code）
### 3-0. まず確認：今いるブランチ（事故防止）
ブランチは「今どの作業台にいるか」です。ここを見落とすと、`main` や `develop` にコミットしてしまいます。

- Sourcetree 左のブランチ一覧で、**太字 / チェックマーク** になっているものが「今いるブランチ」です
- 課題作業中は基本 `feature/...` にいるのが正解です

[ここに Sourcetree の「現在のブランチが分かる場所」のスクリーンショットを挿入]

### 3-1. 編集する（VS Code）
- VS Code でファイルを編集して `保存` する（ここが “変更が発生する瞬間” です）

### 3-2. 変更を確認する（Sourcetree）
- Sourcetree の左側で対象リポジトリを選ぶ
- 上部タブの `File Status`（ファイルステータス）を開く
- `Unstaged files`（未ステージ）に変更ファイルが出ていることを確認

[ここに Sourcetree の「File Status」画面のスクリーンショットを挿入]

### 3-3. ステージングする（コミットに入れる変更を選ぶ）
- `Unstaged files` のファイルをクリックして差分を確認
- 右側の `Stage`（＋/チェック）をクリックして `Staged files` に移す  
  - 「全部まとめて OK」なら “全部ステージ” でも大丈夫です
  - 慣れてきたら「必要なファイルだけ」を選ぶと事故が減ります

### 3-4. コミットする（保存ポイントを作る）
- コミットメッセージを書く（例：`task1: READMEに自己紹介を追加`）
- `Commit` をクリック

**メッセージのコツ**：後で見返したとき「何をしたか」が分かる日本語で OK です。  
（`update` だけは避けましょう）

### 3-5. ログ（履歴）を読む
- `History`（履歴）タブを開く
- 直前のコミットが追加されていることを確認
- コミットをクリックすると「どのファイルをどう変えたか」が見られます

[ここに Sourcetree の「History」画面のスクリーンショットを挿入]

### 3-6. プッシュする（GitHubへ送る）
- 上部の `Push` をクリック
- 送るブランチ（例：`feature/task1`）にチェックが入っていることを確認
- `Push` をクリック

[ここに Sourcetree の「Push」画面のスクリーンショットを挿入]

### 3-7. プルする（GitHubの変更を取り込む）
作業前や、PR がマージされた後は “最新化” が大切です。

- 上部の `Pull` をクリック
- 取り込み先ブランチが正しいか確認（`develop` など）

※ `Fetch` は「ダウンロードだけ」、`Pull` は「ダウンロード＋反映」です。最初は `Pull` で OK。

### 3-8. 事故防止チェック（コミット前 / プッシュ前）
**コミット前**
- `Staged files` に「入れていいファイルだけ」入っている？
- 差分を見て、意図しない変更（空白だけ、設定ファイルなど）が混ざっていない？
- パスワード・トークン・個人情報が入っていない？（例：`.env`、スクショ、メモ）

**プッシュ前**
- 今いるブランチが `feature/...` になっている？
- 送るブランチ（チェック）が正しい？

### 3-9. （おすすめ）`.gitignore` で「余計なファイル」を最初から防ぐ
`.gitignore` は「コミットしないファイル一覧」です。初心者の事故（`node_modules` や `.env` を上げる）を強力に防げます。

例（必要なものだけ入れてOK）:
```gitignore
.DS_Store
node_modules/
.env
```

[ここに `.gitignore` を作成している画面のスクリーンショットを挿入]

## 4. よくあるミス・つまずきポイント
- まとめて巨大なコミットになり、差分が追えない → 「区切り」でコミットする。
- ステージングせずにコミットしようとして「何もコミットされない」 → `Staged files` を確認する。
- プッシュし忘れて、GitHub に反映されていない → 「コミット＝PC内」「プッシュ＝金庫へ」を思い出す。
- プッシュできない（認証エラー） → まずは第1章の SSH 設定を再確認する。

### 4-1. “やり直し”の基本（Sourcetreeで安全に戻る）
初心者は「戻せないのが怖い」と感じがちですが、ここを覚えると一気に安心できます。

#### ステージングを戻したい（コミットに入れたくない）
- `File Status` → `Staged files` の対象ファイルを右クリック
- `Unstage` / `Remove from index` を選ぶ（表示名は環境で異なります）

#### 間違って `.env` などをステージしてしまった（秘密情報は守る）
- まず `Unstage` で外す
- `.gitignore` に `.env` を追加する
- その後、必要なファイルだけをステージしてコミットする

※ もし `.env` を **プッシュまでしてしまった** 場合は、先生に相談してください（基本は「秘密情報を無効化・作り直し」が必要です）。

#### 変更をなかったことにしたい（※戻せないので注意）
- `File Status` → 対象ファイルを右クリック → `Discard` / `Reset` を探す
- 不安なら、先にファイル内容をコピーしてメモに退避してから実行する

#### 直前のコミットメッセージを直したい（まだプッシュしていない）
- もう一度コミット画面を開き、`Amend last commit`（直前コミットを修正）を探す
- メッセージを直してコミット
- その後に `Push`

※ すでにプッシュ済みの場合は、無理に書き換えず「追加コミット」で直すのが安全です。

#### 間違ったコミットを取り消したい（安全版）
履歴を消さずに “打ち消すコミット” を追加する方法です。プッシュ済みでも安全です。

- `History` で取り消したいコミットを右クリック
- `Reverse commit` / `Revert` を選ぶ
- 新しいコミットが追加されたことを確認して `Push`

[ここに Sourcetree の「Reverse commit / Revert」操作のスクリーンショットを挿入]

## 5. AIに聞いてみよう（質問例）
- 「初心者向けに、良いコミットメッセージ例を5つ作って（課題提出用）」
- 「Sourcetree の “Staged files” と “Unstaged files” の違いを超かんたんに説明して」
- 「この差分（スクショ）だと、コミットを分けた方がいい？判断基準を教えて」

## 6. ハンズオン課題（成果物提出を想定）
- `README.md` を編集して、意味のある単位でコミットを2回以上行う（例：自己紹介追加→学習メモ追加）。
- GitHub を開き、コミットが反映されていること（履歴が増えていること）を確認する。

## 7. チェックリスト（理解確認）
- [ ] ステージング／コミット／プッシュの違いを説明できる。
- [ ] Sourcetree の `History` で履歴を確認できる。
- [ ] 「コミットは小さく」を説明できる。
